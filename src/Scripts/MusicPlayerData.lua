mod.ModdedCrossroadSongs = {
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1a_Lyrics = "Song_Scylla1a",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1b_Lyrics = "Song_Scylla1b",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2a_Lyrics = "Song_Scylla2a",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2b_Lyrics = "Song_Scylla2b",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3a_Lyrics = "Song_Scylla3a",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3b_Lyrics = "Song_Scylla3b",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4a_Lyrics = "Song_Scylla4a",
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4b_Lyrics = "Song_Scylla4b",
}

local songWorldUpgradeData = {
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1a_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1a_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla1_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 0,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla1a" },
			},
		},
		Cost = {
			CosmeticsPoints = 400,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1b_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla1b_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla1_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 2,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla1b" },
			},
		},
		Cost = {
			CosmeticsPoints = 600,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2a_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2a_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla2_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 0,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla2a" },
			},
		},
		Cost = {
			CosmeticsPoints = 400,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2b_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla2b_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla2_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 2,
		ModsNikkelMCrossroadSingingSirens_TrackOffset = 521.5,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla2b" },
			},
		},
		Cost = {
			CosmeticsPoints = 600,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3a_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3a_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla3_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 0,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla3a" },
			},
		},
		Cost = {
			CosmeticsPoints = 600,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3b_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla3b_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla3_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 2,
		ModsNikkelMCrossroadSingingSirens_TrackOffset = 504.5,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla3b" },
			},
		},
		Cost = {
			CosmeticsPoints = 800,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4a_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4a_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla4_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 0,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla4a" },
			},
		},
		Cost = {
			CosmeticsPoints = 600,
			MixerGBoss = 1,
		},
	},
	ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4b_Lyrics = {
		Name = "ModsNikkelMCrossroadSingingSirensMusicPlayer_Song_Scylla4b_Lyrics",
		InheritFrom = { "DefaultSongItem" },
		TrackName = "/Music/IrisMusicScylla4_MC",
		ModsNikkelMCrossroadSingingSirens_MusicSection = 2,
		ModsNikkelMCrossroadSingingSirens_TrackOffset = 451.5,

		GameStateRequirements = {
			{
				PathTrue = { "GameState", "WorldUpgradesAdded", "Song_Scylla4b" },
			},
		},
		Cost = {
			CosmeticsPoints = 800,
			MixerGBoss = 1,
		},
	},
}

-- Insert the new song right after the original
for songKey, songValue in pairs(mod.ModdedCrossroadSongs) do
	local insertIndex = nil
	for i, existingSong in ipairs(game.ScreenData.MusicPlayer.Songs) do
		if existingSong == songValue then
			insertIndex = i
			break
		end
	end

	if insertIndex then
		table.insert(game.ScreenData.MusicPlayer.Songs, insertIndex + 1, songKey)
	end
end

-- Make sure the inherited fields are applied properly, then insert the new song data into the WorldUpgradeData table
for songName, songData in pairs(songWorldUpgradeData) do
	game.ProcessDataInheritance(songData, game.WorldUpgradeData)
	game.WorldUpgradeData[songName] = songData
end

-- If the config option is enabled, unlock all songs immediately
if config.unlockEverything then
	modutil.mod.Path.Wrap("DeathAreaRoomTransition", function(base, source, args)
		for songName, _ in pairs(songWorldUpgradeData) do
			game.AddWorldUpgrade(songName)
		end
		base(source, args)
	end)
end
